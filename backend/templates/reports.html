{% extends 'base.html' %} {% block title %}–§—ñ–Ω–∞–Ω—Å–æ–≤—ñ –∑–≤—ñ—Ç–∏{% endblock %} {%
block content %}
<h2>–§—ñ–Ω–∞–Ω—Å–æ–≤—ñ –∑–≤—ñ—Ç–∏</h2>
<p>
  –ú–∏ —Ö–æ—á–µ–º–æ –±—É—Ç–∏ –ø—Ä–æ–∑–æ—Ä–∏–º–∏ —Ç–∞ —á–µ—Å–Ω–∏–º–∏ –∑ –Ω–∞—à–∏–º–∏ –ø–∞—Ç—Ä–æ–Ω–∞–º–∏. –©–æ–º—ñ—Å—è—Ü—è –ø—É–±–ª—ñ–∫—É—î–º–æ
  —Ñ—ñ–Ω–∞–Ω—Å–æ–≤—ñ –∑–≤—ñ—Ç–∏ —Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Ç–≤–∞—Ä–∏–Ω.
</p>

{% if current_user.is_authenticated and current_user.role == 'admin' %}
<p>
  <a href="{{ url_for('reports.add_report') }}">‚ûï –î–æ–¥–∞—Ç–∏ –∑–≤—ñ—Ç</a>
</p>
{% endif %}

<!-- –í–∫–ª–∞–¥–∫–∏ –ø–æ —Ä–æ–∫–∞—Ö -->
<div class="year-tabs">
  {% for y in years %}
  <a href="#year-{{ y }}" class="year-tab">{{ y }}</a>
  {% endfor %}
</div>

<!-- –ö–æ–Ω—Ç–µ–Ω—Ç –ø–æ —Ä–æ–∫–∞—Ö -->
{% for y in years %}
<div id="year-{{ y }}" class="year-block">
  <h3>–ó–≤—ñ—Ç–∏ –∑–∞ {{ y }} —Ä—ñ–∫</h3>

  {% set quarterly = [[], [], [], []] %} {% for report in reports if report.year
  == y %} {% set q = ((report.month_number - 1) // 3) %} {% set _ =
  quarterly[q].append(report) %} {% endfor %} {% for i in range(4) %}
  <div class="quarter-block">
    <h4>{{ ['–ü–µ—Ä—à–∏–π', '–î—Ä—É–≥–∏–π', '–¢—Ä–µ—Ç—ñ–π', '–ß–µ—Ç–≤–µ—Ä—Ç–∏–π'][i] }} –∫–≤–∞—Ä—Ç–∞–ª</h4>

    {% for r in quarterly[i] %}
    <div class="monthly-report">
      <h5>{{ r.month }}</h5>

      {% if current_user.is_authenticated and current_user.role == 'admin' %}
      <form
        method="POST"
        action="{{ url_for('reports.delete_report', report_id=r.id) }}"
      >
        {{ form.hidden_tag() }}
        <button type="submit">üóëÔ∏è</button>
      </form>

      {% endif %}

      <a
        href="{{ url_for('reports.serve_pdf', filename=r.pdf_url.split('/')[-1]) }}"
        >üìÑ –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ PDF</a
      >
    </div>
    {% endfor %}
  </div>
  {% endfor %}
</div>
{% endfor %} {% endblock %}
